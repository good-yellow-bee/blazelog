syntax = "proto3";

package blazelog.v1;

option go_package = "github.com/good-yellow-bee/blazelog/internal/proto/blazelog/v1;blazelogv1";

import "google/protobuf/timestamp.proto";
import "blazelog/v1/common.proto";
import "blazelog/v1/log.proto";

// Alert represents a triggered alert.
message Alert {
  // Name of the rule that triggered.
  string rule_name = 1;

  // Rule description.
  string description = 2;

  // Alert severity.
  Severity severity = 3;

  // Details about what triggered the alert.
  string message = 4;

  // When the alert was triggered.
  google.protobuf.Timestamp timestamp = 5;

  // Number of matching events (for threshold alerts).
  int32 count = 6;

  // Configured threshold (for threshold alerts).
  int32 threshold = 7;

  // Configured window (for threshold alerts).
  string window = 8;

  // Log entry that triggered the alert (for pattern alerts).
  LogEntry triggering_entry = 9;

  // Notification channels.
  repeated string notify = 10;

  // Labels from the rule.
  map<string, string> labels = 11;
}
